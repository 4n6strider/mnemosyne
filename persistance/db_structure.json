some notes on db layout
(aka. weird ramblings and headaches)

SESSION COLLECTION:
{
    "timestamp": "datetime...",
    "source_ip": "string",
    "source_port": "int",
    "destination_ip": "string",
    "destination_port": "int",
    "honeypot": "string, glastopf, dionaea, etc...",
    "protocol": "string, lowercase, http/ssh/telnet/etc",
    "hpfeed_id": "string, _id from hpfeeds",
    "auth_attempts": [
        {
            "type": "plaintext",
            "login": "somelogin",
            "password": "somepassword"
        }
    ],
    "attachments": [
        {
            "format": "someformat",
            "description": "string",
            "data": 
        }
    ]
}

if the session collection contains an attribute with prefix 'session_'
it is meant to contain protocol specific information, example:

{
    "session_http": {
        "request": {
            "url": "theURL",
            "header": "the header...",
            "body": "the body...",
            "host": "host from header",
            "verb": "string, GET, POST, PUT, etc"
        },
        "response": {
            "response_code": "202, 404, etc",
            "header": "the header...",
            "body": "the body..."
        }
    }
}

FILES:
{
  "_id" : "the sha512 of data field...",
  "encoding": "base64",
  "data": "the encoded data...",
  "hpfeed_ids":
    [
      "here goes reference to hpfeed object id",
      "and here another one"
    ],
  "hashes": {
    "md5": "here goes md5 hash",
    "sha1": "here goes sha1 hash",
    "sha512": "here goes sha512 hash"
  }
}

(malicious URL's.....)
URL:
{
    "url": "some url",
     "hpfeed_ids": ["here goes a list of hpfeed _id's"],
     "extractions": ["id's of extractions?"]
}